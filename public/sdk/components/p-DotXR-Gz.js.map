{"file":"p-DotXR-Gz.js","mappings":"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","names":["__stencil_proxyCustomElement","HTMLElement"],"sources":["src/components/searchcraft-search-result/searchcraft-search-result.tsx"],"sourcesContent":["import { Component, Element, Prop, State, h } from '@stencil/core';\nimport type {\n  SearchClientResponseItem,\n  SearchResultTemplate,\n  SearchResultTemplateData,\n} from '@types';\n\nimport type { SearchcraftCore } from '@classes';\nimport { registry } from '@classes/CoreInstanceRegistry';\nimport { html } from '@utils';\n\n/**\n * This web component is designed to display detailed information for a single search result. Once a query is submitted, the component formats and presents the result.\n *\n * @internal\n */\n@Component({\n  tag: 'searchcraft-search-result',\n  shadow: false,\n})\nexport class SearchcraftSearchResult {\n  @Prop() item?: SearchClientResponseItem;\n  /**\n   * The index.\n   */\n  @Prop() index!: number;\n  /**\n   * The position in the document. Used with the \"document_clicked\" measure event.\n   */\n  @Prop() documentPosition = 0;\n  /**\n   * A callback function responsible for rendering a result.\n   */\n  @Prop() template?: SearchResultTemplate<SearchResultTemplateData>;\n  /**\n   * The id of the Searchcraft instance that this component should use.\n   */\n  @Prop() searchcraftId?: string;\n\n  @State() templateHtml: string | undefined;\n  @Element() hostElement?: HTMLElement;\n  core?: SearchcraftCore;\n  private cleanupCore?: () => void;\n\n  onCoreAvailable(core: SearchcraftCore) {\n    this.core = core;\n  }\n\n  connectedCallback() {\n    this.cleanupCore = registry.useCoreInstance(\n      this.searchcraftId,\n      this.onCoreAvailable.bind(this),\n    );\n\n    if (this.item) {\n      try {\n        this.templateHtml = this.template?.(this.item.document, this.index, {\n          html,\n          source_index: this.item.source_index,\n        });\n      } catch (error) {\n        console.error('Invalid search result template:', error);\n      }\n    }\n  }\n\n  disconnectedCallback() {\n    this.cleanupCore?.();\n  }\n\n  handleResultContainerClick = (event: MouseEvent) => {\n    if (!event.target) {\n      return;\n    }\n\n    const target = event.target as HTMLElement;\n    const link = target.closest('a');\n\n    if (\n      !link ||\n      !this.hostElement?.contains(link) ||\n      !this.core ||\n      !this.core.measureClient\n    ) {\n      return;\n    }\n\n    const document_position = this.documentPosition;\n    const search_term = this.core.store.getState().searchTerm;\n    const number_of_documents =\n      this.core.store.getState().searchClientResponseItems.length || 0;\n\n    this.core.measureClient.sendMeasureEvent('document_clicked', {\n      document_position,\n      number_of_documents,\n      search_term,\n    });\n  };\n\n  handleKeyDown = () => {};\n\n  render() {\n    if (!this.item) {\n      return;\n    }\n\n    if (typeof this.template === 'undefined') {\n      return (\n        <div\n          class='searchcraft-search-result searchcraft-search-result-no-template'\n          onClick={this.handleResultContainerClick}\n          onKeyDown={this.handleKeyDown}\n        >\n          {Object.entries(this.item.document).map(([key, value]) => (\n            <p key={key}>\n              <strong>{key}</strong>: {value}\n            </p>\n          ))}\n        </div>\n      );\n    }\n\n    return (\n      <div\n        class='searchcraft-search-result'\n        innerHTML={this.templateHtml}\n        onClick={this.handleResultContainerClick}\n        onKeyDown={this.handleKeyDown}\n      />\n    );\n  }\n}\n"],"version":3}