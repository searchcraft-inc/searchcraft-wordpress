{"file":"p-3286bbb3.js","mappings":";;;;MAoBa,uBAAuB;;;;;IAC1B,IAAI,CAA4B;;;;IAIhC,KAAK,CAAU;;;;IAIf,gBAAgB,GAAG,CAAC,CAAC;;;;IAIrB,QAAQ,CAAkD;;;;IAI1D,aAAa,CAAU;IAEtB,YAAY,CAAqB;;IAE1C,IAAI,CAAmB;IACf,WAAW,CAAc;IAEjC,eAAe,CAAC,IAAqB;QACnC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;KAClB;IAED,iBAAiB;QACf,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,eAAe,CACzC,IAAI,CAAC,aAAa,EAClB,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAChC,CAAC;QAEF,IAAI,IAAI,CAAC,IAAI,EAAE;YACb,IAAI;gBACF,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,EAAE;oBAClE,IAAI;oBACJ,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,YAAY;iBACrC,CAAC,CAAC;aACJ;YAAC,OAAO,KAAK,EAAE;gBACd,OAAO,CAAC,KAAK,CAAC,iCAAiC,EAAE,KAAK,CAAC,CAAC;aACzD;SACF;KACF;IAED,oBAAoB;QAClB,IAAI,CAAC,WAAW,IAAI,CAAC;KACtB;IAED,0BAA0B,GAAG,CAAC,KAAiB;QAC7C,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;YACjB,OAAO;SACR;QAED,MAAM,MAAM,GAAG,KAAK,CAAC,MAAqB,CAAC;QAC3C,MAAM,IAAI,GAAG,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAEjC,IACE,CAAC,IAAI;YACL,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,CAAC,IAAI,CAAC;YACjC,CAAC,IAAI,CAAC,IAAI;YACV,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EACxB;YACA,OAAO;SACR;QAED,MAAM,iBAAiB,GAAG,IAAI,CAAC,gBAAgB,CAAC;QAChD,MAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC;QAC1D,MAAM,mBAAmB,GACvB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,yBAAyB,CAAC,MAAM,IAAI,CAAC,CAAC;QAEnE,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,kBAAkB,EAAE;YAC3D,iBAAiB;YACjB,mBAAmB;YACnB,WAAW;SACZ,CAAC,CAAC;KACJ,CAAC;IAEF,aAAa,GAAG,SAAQ,CAAC;IAEzB,MAAM;QACJ,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YACd,OAAO;SACR;QAED,IAAI,OAAO,IAAI,CAAC,QAAQ,KAAK,WAAW,EAAE;YACxC,QACE,WACE,KAAK,EAAC,iEAAiE,EACvE,OAAO,EAAE,IAAI,CAAC,0BAA0B,EACxC,SAAS,EAAE,IAAI,CAAC,aAAa,IAE5B,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,MACnD,SAAG,GAAG,EAAE,GAAG,IACT,kBAAS,GAAG,CAAU,QAAG,KAAK,CAC5B,CACL,CAAC,CACE,EACN;SACH;QAED,QACE,WACE,KAAK,EAAC,2BAA2B,EACjC,SAAS,EAAE,IAAI,CAAC,YAAY,EAC5B,OAAO,EAAE,IAAI,CAAC,0BAA0B,EACxC,SAAS,EAAE,IAAI,CAAC,aAAa,GAC7B,EACF;KACH;;;;;;;;;;;;;;;;;;;;;;;;;","names":[],"sources":["src/components/searchcraft-search-result/searchcraft-search-result.tsx"],"sourcesContent":["import type {\n  SearchClientResponseItem,\n  SearchResultTemplate,\n  SearchResultTemplateData,\n} from '@types';\nimport { Component, Element, h, Prop, State } from '@stencil/core';\n\nimport { html } from '@utils';\nimport type { SearchcraftCore } from '@classes';\nimport { registry } from '@classes/CoreInstanceRegistry';\n\n/**\n * This web component is designed to display detailed information for a single search result. Once a query is submitted, the component formats and presents the result.\n *\n * @internal\n */\n@Component({\n  tag: 'searchcraft-search-result',\n  shadow: false,\n})\nexport class SearchcraftSearchResult {\n  @Prop() item?: SearchClientResponseItem;\n  /**\n   * The index.\n   */\n  @Prop() index!: number;\n  /**\n   * The position in the document. Used with the \"document_clicked\" measure event.\n   */\n  @Prop() documentPosition = 0;\n  /**\n   * A callback function responsible for rendering a result.\n   */\n  @Prop() template?: SearchResultTemplate<SearchResultTemplateData>;\n  /**\n   * The id of the Searchcraft instance that this component should use.\n   */\n  @Prop() searchcraftId?: string;\n\n  @State() templateHtml: string | undefined;\n  @Element() hostElement?: HTMLElement;\n  core?: SearchcraftCore;\n  private cleanupCore?: () => void;\n\n  onCoreAvailable(core: SearchcraftCore) {\n    this.core = core;\n  }\n\n  connectedCallback() {\n    this.cleanupCore = registry.useCoreInstance(\n      this.searchcraftId,\n      this.onCoreAvailable.bind(this),\n    );\n\n    if (this.item) {\n      try {\n        this.templateHtml = this.template?.(this.item.document, this.index, {\n          html,\n          source_index: this.item.source_index,\n        });\n      } catch (error) {\n        console.error('Invalid search result template:', error);\n      }\n    }\n  }\n\n  disconnectedCallback() {\n    this.cleanupCore?.();\n  }\n\n  handleResultContainerClick = (event: MouseEvent) => {\n    if (!event.target) {\n      return;\n    }\n\n    const target = event.target as HTMLElement;\n    const link = target.closest('a');\n\n    if (\n      !link ||\n      !this.hostElement?.contains(link) ||\n      !this.core ||\n      !this.core.measureClient\n    ) {\n      return;\n    }\n\n    const document_position = this.documentPosition;\n    const search_term = this.core.store.getState().searchTerm;\n    const number_of_documents =\n      this.core.store.getState().searchClientResponseItems.length || 0;\n\n    this.core.measureClient.sendMeasureEvent('document_clicked', {\n      document_position,\n      number_of_documents,\n      search_term,\n    });\n  };\n\n  handleKeyDown = () => {};\n\n  render() {\n    if (!this.item) {\n      return;\n    }\n\n    if (typeof this.template === 'undefined') {\n      return (\n        <div\n          class='searchcraft-search-result searchcraft-search-result-no-template'\n          onClick={this.handleResultContainerClick}\n          onKeyDown={this.handleKeyDown}\n        >\n          {Object.entries(this.item.document).map(([key, value]) => (\n            <p key={key}>\n              <strong>{key}</strong>: {value}\n            </p>\n          ))}\n        </div>\n      );\n    }\n\n    return (\n      <div\n        class='searchcraft-search-result'\n        innerHTML={this.templateHtml}\n        onClick={this.handleResultContainerClick}\n        onKeyDown={this.handleKeyDown}\n      />\n    );\n  }\n}\n"],"version":3}