{"file":"searchcraft-filter-panel.js","mappings":"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","names":["SearchcraftFilterPanel"],"sources":["src/components/searchcraft-filter-panel/searchcraft-filter-panel.tsx"],"sourcesContent":["import type { SearchcraftCore } from '@classes';\nimport { registry } from '@classes/CoreInstanceRegistry';\nimport { Component, Prop, State, h } from '@stencil/core';\nimport type {\n    DateRangeFilterItem,\n    ExactMatchToggleFilterItem,\n    FacetsFilterItem,\n    FilterItem,\n    MostRecentToggleFilterItem,\n    NumericFilterItem,\n} from '@types';\n\n/**\n * This web component represents a series of filters that allows users to refine and control their search queries by applying various filter criteria.\n *\n * @react-import\n * ```jsx\n * import { SearchcraftFilterPanel } from \"@searchcraft/react-sdk\";\n * ```\n *\n * @vue-import\n * ```jsx\n * import { SearchcraftFilterPanel } from \"@searchcraft/vue-sdk\";\n * ```\n *\n * @js-example\n * ```html\n * <!-- index.html -->\n * <searchcraft-filter-panel />\n * ```\n *\n * ```js\n * // index.js\n * const filterPanel = document.querySelector('searchcraft-filter-panel');\n *\n * if (filterPanel) {\n *   filterPanel.items = [];\n * }\n * ```\n *\n * @react-example\n * ```jsx\n * <SearchcraftFilterPanel items={[]} />\n * ```\n *\n * @vue-example\n * ```jsx\n * <SearchcraftFilterPanel :items=\"[]\" />\n * ```\n */\n@Component({\n  tag: 'searchcraft-filter-panel',\n  shadow: false,\n})\nexport class SearchcraftFilterPanel {\n  /**\n   * The id of the Searchcraft instance that this component should use.\n   */\n  @Prop() searchcraftId?: string;\n  /**\n   * The items to filter.\n   */\n  @Prop() items: FilterItem[] = [];\n\n  @State() lastSearchTerm: string | undefined;\n\n  private core?: SearchcraftCore;\n  private unsubscribe?: () => void;\n  private cleanupCore?: () => void;\n\n  onCoreAvailable(core: SearchcraftCore) {\n    this.core = core;\n    this.setInitialDateRanges();\n    this.unsubscribe = core.store.subscribe((state) => {\n      if (this.lastSearchTerm !== state.searchTerm) {\n        // A place to put actions to do when the query changes\n      }\n      this.lastSearchTerm = state.searchTerm || '';\n    });\n  }\n\n  componentDidLoad() {\n    this.cleanupCore = registry.useCoreInstance(\n      this.searchcraftId,\n      this.onCoreAvailable.bind(this),\n    );\n  }\n\n  disconnectedCallback() {\n    this.unsubscribe?.();\n    this.cleanupCore?.();\n  }\n\n  /**\n   * Sets the initial min/max date range values for search queries based on the filter items provided.\n   */\n  setInitialDateRanges() {\n    for (const item of this.items) {\n      if (item.type === 'dateRange') {\n        const dateItem = item as DateRangeFilterItem;\n\n        const startingMinDate = dateItem.options.minDate;\n        const startingMaxDate = dateItem.options.maxDate || new Date();\n\n        this.core?.store.getState()?.addRangeValueForIndexField({\n          fieldName: dateItem.fieldName,\n          value: `${dateItem.fieldName}:[${startingMinDate.toISOString()} TO ${startingMaxDate.toISOString()}]`,\n        });\n      }\n    }\n  }\n\n  handleDateRangeChanged(item: DateRangeFilterItem, min: number, max: number) {\n    const start = new Date(min);\n    const end = new Date(max);\n    this.core?.store.getState()?.addRangeValueForIndexField({\n      fieldName: item.fieldName,\n      value: `${item.fieldName}:[${start.toISOString()} TO ${end.toISOString()}]`,\n    });\n\n    this.core?.store.getState()?.search();\n  }\n\n  handleNumericRangeChanged(fieldName: string, min: number, max: number) {\n    this.core?.store.getState()?.addRangeValueForIndexField({\n      fieldName,\n      value: `${fieldName}:[${min} TO ${max}]`,\n    });\n    this.core?.store.getState()?.search();\n  }\n\n  handleFacetSelectionUpdated(fieldName: string, paths: string[]) {\n    if (paths.length > 0) {\n      this.core?.store.getState()?.addFacetPathsForIndexField({\n        fieldName,\n        value: `${fieldName}: IN [${paths.join(' ')}]`,\n      });\n    } else {\n      this.core?.store.getState()?.removeFacetPathsForIndexField(fieldName);\n    }\n    this.core?.store.getState()?.search();\n  }\n\n  handleExactMatchToggleUpdated(isActive: boolean) {\n    this.core?.store.getState()?.setSearchMode(isActive ? 'exact' : 'fuzzy');\n    this.core?.store.getState()?.search();\n  }\n\n  handleMostRecentToggleUpdated(fieldName: string, isActive: boolean) {\n    if (isActive) {\n      this.core?.store.getState()?.setSortOrder({\n        orderByField: fieldName,\n        sortType: 'desc',\n      });\n    } else {\n      this.core?.store.getState()?.setSortOrder({\n        orderByField: null,\n        sortType: null,\n      });\n    }\n    this.core?.store.getState()?.search();\n  }\n\n  /**\n   * Iterate through `items` and render them based on `type`\n   */\n  render() {\n    return (\n      <div class='searchcraft-filter-panel'>\n        {this.items.map((filterItem) => {\n          switch (filterItem.type) {\n            case 'dateRange': {\n              const item = filterItem as DateRangeFilterItem;\n              const maxDate = item.options.maxDate || new Date();\n\n              // return date range slider\n              return (\n                <div class='searchcraft-filter-panel-section'>\n                  <p class='searchcraft-filter-panel-label'>\n                    {filterItem.label}\n                  </p>\n                  <searchcraft-slider\n                    min={item.options.minDate.getTime()}\n                    max={maxDate.getTime()}\n                    dataType='date'\n                    step={1}\n                    dateGranularity={item.options.granularity}\n                    onRangeChanged={(event) => {\n                      this.handleDateRangeChanged(\n                        item,\n                        event.detail.startValue,\n                        event.detail.endValue,\n                      );\n                    }}\n                  />\n                </div>\n              );\n            }\n            case 'numericRange': {\n              const item = filterItem as NumericFilterItem;\n              // return date range slider\n              return (\n                <div class='searchcraft-filter-panel-section'>\n                  <p class='searchcraft-filter-panel-label'>\n                    {filterItem.label}\n                  </p>\n                  <searchcraft-slider\n                    min={item.options.min}\n                    max={item.options.max}\n                    step={item.options.granularity}\n                    onRangeChanged={(event) => {\n                      this.handleNumericRangeChanged(\n                        item.fieldName,\n                        event.detail.startValue,\n                        event.detail.endValue,\n                      );\n                    }}\n                  />\n                </div>\n              );\n            }\n            case 'facets': {\n              const item = filterItem as FacetsFilterItem;\n              // return \"filters-list\"\n              return (\n                <div class='searchcraft-filter-panel-section'>\n                  <p class='searchcraft-filter-panel-label'>\n                    {filterItem.label}\n                  </p>\n                  <searchcraft-facet-list\n                    fieldName={item.fieldName}\n                    onFacetSelectionUpdated={(event) => {\n                      this.handleFacetSelectionUpdated(\n                        item.fieldName,\n                        event.detail.paths,\n                      );\n                    }}\n                  />\n                </div>\n              );\n            }\n            case 'exactMatchToggle': {\n              const item = filterItem as ExactMatchToggleFilterItem;\n              return (\n                <searchcraft-toggle-button\n                  label={item.label}\n                  subLabel={item.options.subLabel}\n                  onToggleUpdated={(event) => {\n                    this.handleExactMatchToggleUpdated(event.detail);\n                  }}\n                />\n              );\n            }\n            case 'mostRecentToggle': {\n              const item = filterItem as MostRecentToggleFilterItem;\n              return (\n                <searchcraft-toggle-button\n                  label={item.label}\n                  subLabel={item.options.subLabel}\n                  onToggleUpdated={(event) => {\n                    this.handleMostRecentToggleUpdated(\n                      item.fieldName,\n                      event.detail,\n                    );\n                  }}\n                />\n              );\n            }\n          }\n        })}\n      </div>\n    );\n  }\n}\n"],"version":3}