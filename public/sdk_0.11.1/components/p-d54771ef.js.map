{"file":"p-d54771ef.js","mappings":"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","names":[],"sources":["src/utils/units.ts"],"sourcesContent":["import type { SearchResultMapping } from '@types';\n\n/**\n * Given a document and a SearchResultMapping, return a mapped value from the document.\n * Applies formatting based on the values specified in the `SearchResultFieldName` values.\n *\n * @param document\n * @param {SearchResultMapping} mapping\n * @returns {string | undefined}\n */\nexport function getDocumentValueFromSearchResultMapping(\n  document: Record<string, unknown> | undefined,\n  mapping: SearchResultMapping | undefined,\n): string | undefined {\n  if (document && mapping) {\n    return mapping.fieldNames\n      .map((fieldNameDetails) => {\n        let valueFound = document[fieldNameDetails.fieldName];\n\n        if (valueFound) {\n          switch (fieldNameDetails.dataType) {\n            case 'date': {\n              valueFound = formatRelativeDate(\n                valueFound as string | Date,\n                fieldNameDetails.dateFormatLocale,\n                fieldNameDetails.dateFormatOptions,\n              );\n              break;\n            }\n            case 'number': {\n              valueFound = Intl.NumberFormat(\n                fieldNameDetails.numberFormatLocale,\n                fieldNameDetails.numberFormatOptions,\n              ).format(\n                (valueFound as number) * (fieldNameDetails.numberScale || 1),\n              );\n              break;\n            }\n            default:\n              break;\n          }\n        }\n\n        return valueFound;\n      })\n      .filter((value) => !!value)\n      .join(mapping.delimiter || ' ');\n  }\n}\n\n/**\n * Convert different units of time to milliseconds.\n *\n * @param unit - The unit of time\n * @returns {number}\n */\nexport function getMillis(unit: 'year' | 'month' | 'day' | 'hour'): number {\n  const millisInHour = 60 * 60 * 1000;\n  const millisInDay = 24 * millisInHour;\n  const millisInMonth = 30 * millisInDay;\n  const millisInYear = 365 * millisInDay;\n\n  switch (unit) {\n    case 'hour':\n      return millisInHour;\n    case 'day':\n      return millisInDay;\n    case 'month':\n      return millisInMonth;\n    case 'year':\n      return millisInYear;\n    default:\n      return 3600000;\n  }\n}\n\n/**\n * Format a number with commas as thousands separators.\n *\n * @param number - The number to be formatted.\n * @returns {string} - The formatted number as a string.\n */\nexport function formatNumberWithCommas(number) {\n  return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n}\n\n/**\n * Format a date or date string. The string is formatted relative to today's date\n * (e.g. 2 days ago) until the date range is greater than a month.\n *\n * @param dateInput - The date to be formatted.\n * @param locale - The language used for formatting the date.\n * @param options - The non-default options used for formatting the date.\n * @returns {string} - The formatted date as a string.\n */\nexport function formatRelativeDate(\n  dateInput: string | Date,\n  locale = 'en-US',\n  options: Intl.DateTimeFormatOptions = {\n    day: 'numeric',\n    month: 'long',\n    year: 'numeric',\n  },\n): string {\n  const date = new Date(dateInput);\n  const now = new Date();\n  const diffMillis = now.getTime() - date.getTime();\n  const oneMonthInMillis = 30 * 24 * 60 * 60 * 1000; // Approx. 1 month in ms\n\n  if (diffMillis < oneMonthInMillis) {\n    const diffSeconds = Math.trunc(diffMillis / 1000);\n    const diffMinutes = Math.trunc(diffSeconds / 60);\n    const diffHours = Math.trunc(diffMinutes / 60);\n    const diffDays = Math.trunc(diffHours / 24);\n    const relativeTimeFormat = new Intl.RelativeTimeFormat(locale, options);\n\n    if (diffDays >= 1) {\n      return relativeTimeFormat.format(-diffDays, 'day');\n    }\n\n    if (diffHours >= 1) {\n      return relativeTimeFormat.format(-diffHours, 'hour');\n    }\n\n    if (diffMinutes >= 1) {\n      return relativeTimeFormat.format(-diffMinutes, 'minute');\n    }\n\n    return relativeTimeFormat.format(0, 'second');\n  }\n\n  return new Intl.DateTimeFormat(locale, options).format(date);\n}\n\n/**\n * Given a date, returns the timestamp (in ms) for the start of the specified unit.\n *\n * @param unit - The unit to calculate the start of ('year' | 'month' | 'day' | 'hour').\n * @param timestamp - The date to evaluate.\n * @param offset - The number of units to offset by.\n * @returns The timestamp (in ms) for the start of the specified unit.\n */\nexport function getStartOf(\n  timestamp: number,\n  unit: 'year' | 'month' | 'day' | 'hour',\n  offset = 0,\n): number {\n  const d = new Date(timestamp);\n\n  switch (unit) {\n    case 'year':\n      return new Date(d.getFullYear() + offset, 0, 1, 0, 0, 0, 0).getTime();\n    case 'month':\n      return new Date(\n        d.getFullYear(),\n        d.getMonth() + offset,\n        1,\n        0,\n        0,\n        0,\n        0,\n      ).getTime();\n    case 'day':\n      return new Date(\n        d.getFullYear(),\n        d.getMonth(),\n        d.getDate() + offset,\n        0,\n        0,\n        0,\n        0,\n      ).getTime();\n    case 'hour':\n      return new Date(\n        d.getFullYear(),\n        d.getMonth(),\n        d.getDate(),\n        d.getHours() + offset,\n        0,\n        0,\n        0,\n      ).getTime();\n    default:\n      throw new Error(`Unsupported unit: ${unit}`);\n  }\n}\n\n/**\n * Given a start and end date, returns the difference in the number of the specified units.\n *\n * @param units - The unit to measure ('year' | 'month' | 'day' | 'hour').\n * @param startDate - The start date.\n * @param endDate - The end date.\n * @returns The difference in the given unit.\n */\nexport function getDifferenceInUnits(\n  unit: 'year' | 'month' | 'day' | 'hour',\n  startTime: number,\n  endTime: number,\n): number {\n  const start = new Date(startTime);\n  const end = new Date(endTime);\n\n  switch (unit) {\n    case 'year':\n      return Math.abs(end.getFullYear() - start.getFullYear());\n\n    case 'month':\n      return Math.abs(\n        end.getFullYear() * 12 +\n          end.getMonth() -\n          (start.getFullYear() * 12 + start.getMonth()),\n      );\n\n    case 'day':\n      return Math.floor(\n        Math.abs(end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24),\n      );\n\n    case 'hour':\n      return Math.floor(\n        Math.abs(end.getTime() - start.getTime()) / (1000 * 60 * 60),\n      );\n\n    default:\n      throw new Error(`Unsupported unit: ${unit}`);\n  }\n}\n\n/**\n * Returns the ordinal representation of a day of the month.\n */\nconst getOrdinal = (n: number): string => {\n  if (n >= 11 && n <= 13) return `${n}th`;\n  switch (n % 10) {\n    case 1:\n      return `${n}st`;\n    case 2:\n      return `${n}nd`;\n    case 3:\n      return `${n}rd`;\n    default:\n      return `${n}th`;\n  }\n};\n\n/**\n * Given a granularity level, returns a formatted, human-readable, date string.\n *\n * @param granularity - The granularity level to display. The granularity level dictates how the date is formatted.\n * @param date - The date to format.\n *\n * @returns A formatted string representing the date at the specified granularity.\n *\n * @example\n * getFormattedDateString('year', new Date('2023-01-01')) // \"2023\"\n * getFormattedDateString('month', new Date('2023-01-01')) // \"Jan 2023\"\n * getFormattedDateString('day', new Date('2023-01-31')) // \"Jan 31st, 2023\"\n * getFormattedDateString('hour', new Date('2023-01-31T12:00:00')) // \"Jan 31st, 12:00 PM\"\n */\nexport function getFormattedDateString(\n  granularity: 'year' | 'month' | 'day' | 'hour',\n  date: Date,\n): string {\n  const monthFormatter = new Intl.DateTimeFormat('en-US', { month: 'short' });\n\n  switch (granularity) {\n    case 'year':\n      return date.getFullYear().toString();\n\n    case 'month':\n      return `${monthFormatter.format(date)} ${date.getFullYear()}`;\n\n    case 'day':\n      return `${monthFormatter.format(date)} ${getOrdinal(date.getDate())}, ${date.getFullYear()}`;\n\n    case 'hour': {\n      const timeFormatter = new Intl.DateTimeFormat('en-US', {\n        hour: 'numeric',\n        minute: '2-digit',\n        hour12: true,\n      });\n      return `${monthFormatter.format(date)} ${getOrdinal(date.getDate())}, ${timeFormatter.format(date)}`;\n    }\n    default:\n      throw new Error(`Unsupported granularity: ${granularity}`);\n  }\n}\n"],"version":3}