{"file":"p-c9b65e8f.js","mappings":"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","names":[],"sources":["src/utils/throttle.ts","src/components/searchcraft-slider/searchcraft-slider.tsx"],"sourcesContent":["/**\n * Creates a throttled version of the given function that only invokes\n * the original function at most once every specified number of milliseconds.\n *\n * The logic is written in a way that the last invocation is always called, after the\n * throttle cooldown period has ended.\n *\n * @template Arguments - The argument types for the function to throttle\n * @param callback - The function to throttle\n * @param delayInMilliseconds - The number of milliseconds to wait before allowing the next invocation\n * @returns A throttled version of the original function\n */\nexport function throttle<\n  // biome-ignore lint/suspicious/noExplicitAny: To be an effective util, this needs to be flexibile enough allow any type of arguments.\n  Arguments extends any[],\n>(\n  callback: (...args: Arguments) => void,\n  delayInMilliseconds: number,\n): (...args: Arguments) => void {\n  let isThrottleOnCooldown = false;\n  let trailingCallArgs: Arguments | null = null;\n\n  const invokeAction = (args: Arguments) => {\n    callback(...args);\n    isThrottleOnCooldown = true;\n    setTimeout(() => {\n      isThrottleOnCooldown = false;\n      if (trailingCallArgs) {\n        const nextArgs = trailingCallArgs;\n        trailingCallArgs = null;\n        invokeAction(nextArgs);\n      }\n    }, delayInMilliseconds);\n  };\n\n  return (...args: Arguments) => {\n    if (!isThrottleOnCooldown) {\n      invokeAction(args);\n    } else {\n      trailingCallArgs = args;\n    }\n  };\n}\n","import {\n  Component,\n  Event,\n  type EventEmitter,\n  h,\n  State,\n  Prop,\n} from '@stencil/core';\nimport {\n  getDifferenceInUnits,\n  getFormattedDateString,\n  getStartOf,\n} from '@utils';\nimport { throttle } from '@utils/throttle';\nimport classNames from 'classnames';\n\n/**\n * This web component is designed to allow users to select a value from a range defined by a minimum and maximum value. The component renders a slider interface, which can be used to visually choose a value between two boundaries.\n *\n * @internal\n */\n@Component({\n  tag: 'searchcraft-slider',\n  shadow: false,\n})\nexport class SearchcraftSlider {\n  /**\n   * The maximum value allowed.\n   */\n  @Prop() max = 100;\n  /**\n   * The minimum value allowed.\n   */\n  @Prop() min = 0;\n  /**\n   * The step amount for the slider inputs.\n   */\n  @Prop() step = 1;\n  /** The type of data the sliders are using. */\n  @Prop() dataType: 'number' | 'date' = 'number';\n  /** The date granularity to use. Used to format date labels. */\n  @Prop() dateGranularity?: 'year' | 'month' | 'day' | 'hour';\n\n  @State() lowerBound = 0;\n  @State() upperBound = 1;\n  @State() endValue = 0;\n  @State() startValue = 0;\n  @State() lastFocusedHandle: 'min' | 'max' = 'max';\n\n  throttledEmitUpdate: () => void = () => {};\n\n  /**\n   * When the range has changed.\n   * */\n  @Event() rangeChanged:\n    | EventEmitter<{ startValue: number; endValue: number }>\n    | undefined;\n\n  connectedCallback() {\n    switch (this.dataType) {\n      case 'number':\n        this.startValue = this.min;\n        this.endValue = this.max;\n        this.lowerBound = this.min;\n        this.upperBound = this.max;\n        break;\n      case 'date': {\n        this.startValue = 0;\n        this.endValue = getDifferenceInUnits(\n          this.dateGranularity || 'year',\n          this.min,\n          this.max,\n        );\n        this.lowerBound = 0;\n        this.upperBound = this.endValue;\n\n        break;\n      }\n    }\n\n    this.throttledEmitUpdate = throttle(this.emitUpdate, 120);\n  }\n\n  private emitUpdate = async () => {\n    switch (this.dataType) {\n      case 'number':\n        this.rangeChanged?.emit({\n          startValue: this.startValue,\n          endValue: this.endValue,\n        });\n        break;\n      case 'date': {\n        const granularity = this.dateGranularity || 'year';\n        const startTimestamp = getStartOf(\n          this.min,\n          granularity,\n          this.lowerBound + this.startValue,\n        );\n        const endTimestamp = getStartOf(\n          this.min,\n          granularity,\n          this.lowerBound + this.endValue + 1,\n        );\n        this.rangeChanged?.emit({\n          startValue: startTimestamp,\n          endValue: endTimestamp,\n        });\n        break;\n      }\n    }\n  };\n\n  private handleStartValueChange = (event: InputEvent) => {\n    const inputElement = event.target as HTMLInputElement;\n    const value = Number.parseInt(inputElement.value, 10);\n    this.lastFocusedHandle = 'min';\n\n    if (value <= this.endValue) {\n      this.startValue = value;\n      this.throttledEmitUpdate();\n    } else {\n      this.startValue = this.endValue;\n      inputElement.value = `${this.endValue}`;\n    }\n  };\n\n  private handleEndValueChange = (event: InputEvent) => {\n    const inputElement = event.target as HTMLInputElement;\n    const value = Number.parseInt(inputElement.value, 10);\n    this.lastFocusedHandle = 'max';\n\n    if (value >= this.startValue) {\n      this.endValue = value;\n      this.throttledEmitUpdate();\n    } else {\n      this.endValue = this.startValue;\n      inputElement.value = `${this.startValue}`;\n    }\n  };\n\n  private getLabel = (value): string => {\n    switch (this.dataType) {\n      case 'number':\n        return `${this.startValue}`;\n      case 'date': {\n        const granularity = this.dateGranularity || 'year';\n        const dateOffset = this.lowerBound + value;\n        const timestamp = getStartOf(this.min, granularity, dateOffset);\n\n        return getFormattedDateString(\n          this.dateGranularity || 'year',\n          new Date(timestamp),\n        );\n      }\n    }\n  };\n\n  render() {\n    const startPercent =\n      ((this.startValue - this.lowerBound) /\n        (this.upperBound - this.lowerBound)) *\n      100;\n    const endPercent =\n      ((this.endValue - this.lowerBound) /\n        (this.upperBound - this.lowerBound)) *\n      100;\n\n    const startLabel = this.getLabel(this.startValue);\n    const endLabel = this.getLabel(this.endValue);\n\n    return (\n      <div class='searchcraft-slider'>\n        <div class='searchcraft-slider-range'>\n          <div\n            class='searchcraft-slider-active-range'\n            style={{\n              left: `${startPercent}%`,\n              width: `${endPercent - startPercent}%`,\n            }}\n          />\n          <input\n            class={classNames(\n              'searchcraft-slider-input',\n              'searchcraft-slider-input-min-handle',\n            )}\n            max={this.upperBound}\n            min={this.lowerBound}\n            onInput={this.handleStartValueChange.bind(this)}\n            step={this.step}\n            style={{ zIndex: this.lastFocusedHandle === 'min' ? '2' : '1' }}\n            type='range'\n            value={this.startValue}\n          />\n          <input\n            class={classNames(\n              'searchcraft-slider-input',\n              'searchcraft-slider-input-max-handle',\n            )}\n            max={this.upperBound}\n            min={this.lowerBound}\n            onInput={this.handleEndValueChange.bind(this)}\n            step={this.step}\n            style={{ zIndex: this.lastFocusedHandle === 'max' ? '2' : '1' }}\n            type='range'\n            value={this.endValue}\n          />\n        </div>\n        <div class='searchcraft-slider-label'>\n          <span class='searchcraft-slider-start-label'>{startLabel}</span>\n          <span class='searchcraft-slider-end-label'>{endLabel}</span>\n        </div>\n      </div>\n    );\n  }\n}\n"],"version":3}